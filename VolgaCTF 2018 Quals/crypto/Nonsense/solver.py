import hashlib
from gmpy2 import invert

examples = [
    ('VolgaCTF{nKpV/dmkBeQ0n9Mz0g9eGQ==}', 1030409245884476193717141088285092765299686864672, 830067187231135666416948244755306407163838542785),
    ('VolgaCTF{KtetaQ4YT8PhTL3O4vsfDg==}', 403903893160663712713225718481237860747338118174,  803753330562964683180744246754284061126230157465)
]

if __name__ == "__main__":
    g = 88125476599184486094790650278890368754888757655708027167453919435240304366395317529470831972495061725782138055221217302201589783769854366885231779596493602609634987052252863192229681106120745605931395095346012008056087730365567429009621913663891364224332141824100071928803984724198563312854816667719924760795
    y = 18433140630820275907539488836516835408779542939919052226997023049612786224410259583219376467254099629677919271852380455772458762645735404211432242965871926570632297310903219184400775850110990886397212284518923292433738871549404880989194321082225561448101852260505727288411231941413212099434438610673556403084
    p = 89884656743115795425395461605176038709311877189759878663122975144592708970495081723016152663257074178905267744494172937616748015651504839967430700901664125135185879852143653824715409554960402343311756382635207838848036159350785779959423221882215217326708017212309285537596191495074550701770862125817284985959
    q = 1118817215266473099401489299835945027713635248219
    a = 3437776292996777467976657547577967657547
    b = 828669865469592426262363475477574643634

    (m1,r1,s1),(m2,r2,s2) = examples
    h1 = int(hashlib.md5(m1.encode()).hexdigest(), 16)
    h2 = int(hashlib.md5(m2.encode()).hexdigest(), 16)

    inv1 = invert(r1, q)
    inv2 = invert(r2, q)
    c = (s2 * a) % q
    d = (h2 - s2 * b) % q
    k = (invert(s1*inv1 - c*inv2,q)*(h1*inv1-d*inv2))%q
    print('k1:', k)
    print('x:', hex(((s1*k - h1)*invert(r1,q))%q))